---
title: "Одноранговый VPN с vpncloud"
date: 2020-06-07
draft: false
tags: "Компьютер"
shorttext: "Любой, кто называет несколько собственных серверов, может нуждаться в сети VPN для мониторинга и так далее. Я здесь, vpncloud."
cover: "computer"
lang: ru
---

Те, кто называет несколько серверов своими собственными и хочет гарантировать соответствующую доступность, размещают их в географически распределенных центрах обработки данных. Связь между серверами затруднена, и часто этот внутренний трафик проходит незашифрованным.

Здесь [vpncloud как одноранговый VPN](https://github.com/dswd/vpncloud "Peer-to-Peer VPN") предлагает себя. В дополнение к простой настройке есть следующие основные моменты говорят для vpncloud :

  - vpncloud подключает сеть VPN к своему собственному интерфейсу, который может быть свободно настроен с соответствующими IP-адресами.

  - vpncloud создал полностью сетевую одноранговую VPN-сеть. Это означает, что vpncloud автоматически подключает серверы на основе IP-адресов.

  - VPN-туннель зашифрован с помощью AES-256

  - в случае потери соединения vpncloud автоматически подключается снова

  - [очень хорошее выступление](https://vpncloud.ddswd.de/features/performance/ "Performance Measurements")

  - это открытый исходный код

  - его легко настроить

  - он стабилен, у меня есть vpncloud на 9 серверах в использовании, включая Rasspberry PI

#### Установка

Во-первых, вы должны установить vpncloud на каждом сервере, который принадлежит к кластеру серверов. Существуют готовые пакеты для дистрибутивов на основе Debian, под Arch (Arm, amd64) соответствующий пакет может быть установлен с aur.


```bash
wget https://github.com/dswd/vpncloud/releases/download/v1.3.0/vpncloud_1.3.0_amd64.deb
sudo dpkg -i vpncloud_1.3.0_amd64.deb
```

Служба Systemd будет установлена автоматически.

#### Конфигурация

Конфигурацию можно найти в каталоге /etc/vpncloud, соответствующий пример файла доступен. Вы копируете его как новый файл и можете редактировать его соответствующим образом.

```bash
sudo cp example.net.disabled mynet.net
sudo nano mynet.net
```

Сначала мы познакомим вас с участниками. Это делается со сверстниками.

```yaml
peers:
  - firstip:3210
  - secoundip:3210  
```

Порт может быть адаптирован к вашим потребностям. Вы также можете указать имена хостов или указать их в файле /etc / hosts.

###### общий ключ

Общий ключ, используемый для шифрования, должен быть соответственно безопасным и одинаковым на всех машинах.

```yaml
shared_key: "nT4gAGSP!S9!2Rjb9%h*gdVN*8NszP"
```

###### Шифрование

vpncloud использует ChaCha20 в качестве своего алгоритма в настройках по умолчанию. Для более новых и быстрых процессоров вы должны использовать AES-256 для повышения производительности.

```yaml
crypto: aes256
```

###### Интерфейс

Наконец, вы должны указать параметры Ifdown / Ifup, эти команды выполняются vpncloud для загрузки и выключения интерфейса.

```yaml
ifup: "ifconfig $IFNAME 10.0.1.1/8 mtu 1400"
ifdown: "ifconfig $IFNAME down"
```

###### Давай убежим

Как я уже сказал, установлен сервис systemd, который делает запуск, остановку и автоматический запуск очень легкими. Следующая команда достаточна для автоматического и немедленного запуска.

```bash
systemctl enable --now vpncloud@mynet 
```

Возможные ошибки можно найти с помощью status, или journalctl. Хосты должны быть доступны через Ping. Отныне-базы данных, инструменты мониторинга и прочее.могут общаться друг с другом через зашифрованный трафик.
